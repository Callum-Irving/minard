{% extends "layout.html" %}
{% block title %}PCA Validation #2{% endblock %}
{% block head %}
  {{ super() }}
{% endblock %}
{% block body %}
  {{ super() }}

  {% macro print_flag(flag) -%}
    {% if flag == 0 %}
    <span style="color:red">0</span>
    {% endif %}
    {% if flag == 1 %}
    <span style="color:green">1</span>
    {% endif %}
  {%- endmacro %}

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1 style="text-align:center">TELLIE PCA Run: {{ run }}</h1>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <h2 style="text-align:center">Validation #2</h2>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h1 class="panel-title"><b>Time-of-Flight</b></h1>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-12">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th width="25.0%">Parameter</th>
                      <th width="25.0%">Value</th>
                      <th width="50.0%">Note</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>TOF mean</td>
                      <td>{{ '%0.2f' | format(data["TOF mean"]|float) }} ns</td>
                      <td>The mean of the time of flight distribution</td>
                    </tr>
                    <tr>
                      <td>TOF RMS</td>
                      <td>{{ '%0.3f' | format(data["TOF RMS"]|float) }} ns</td>
                      <td>The RMS of the time of flight distribution</td>
                    </tr>
                    <tr>
                      <td>TOF min</td>
                      <td>{{ '%0.2f' | format(data["TOF min"]|float) }} ns</td>
                      <td>Minimum value of the time of flight distribution</td>
                    </tr>
                    <tr>
                      <td>TOF max</td>
                      <td>{{ '%0.2f' | format(data["TOF max"]|float) }} ns</td>
                      <td>Maximum value of the time of flight distribution</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h1 class="panel-title"><b>Angular systematic effect</b></h1>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-12">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th width="25.0%">Parameter</th>
                      <th width="25.0%">Value</th>
                      <th width="50.0%">Note</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Ang sys mean</td>
                      <td>{{ '%0.2f' | format(data["Ang sys mean"]|float) }} ns</td>
                      <td>The mean of the AngSys distribution</td>
                    </tr>
                    <tr>
                      <td>Ang sys RMS</td>
                      <td>{{ '%0.3f' | format(data["Ang sys RMS"]|float) }} ns</td>
                      <td>The RMS of the AngSys distribution</td>
                    </tr>
                    <tr>
                      <td>Ang sys min</td>
                      <td>{{ '%0.2f' | format(data["Ang sys min"]|float) }} ns</td>
                      <td>Minimum value of the AngSys distribution</td>
                    </tr>
                    <tr>
                      <td>Ang sys max</td>
                      <td>{{ '%0.2f' | format(data["Ang sys max"]|float) }} ns</td>
                      <td>Maximum value of the AngSys distribution</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h1 class="panel-title"><b>Bucket time</b></h1>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-12">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th width="25.0%">Parameter</th>
                      <th width="25.0%">Value</th>
                      <th width="50.0%">Note</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Bucket mean</td>
                      <td>{{ '%0.2f' | format(data["Bucket mean"]|float) }} ns</td>
                      <td>The mean of the bucket time distribution</td>
                    </tr>
                    <tr>
                      <td>Bucket RMS</td>
                      <td>{{ '%0.3f' | format(data["Bucket RMS"]|float) }} ns</td>
                      <td>The RMS of the bucket time distribution</td>
                    </tr>
                    <tr>
                      <td>Bucket min</td>
                      <td>{{ '%0.2f' | format(data["Bucket min"]|float) }} ns</td>
                      <td>Minimum value of the bucket time distribution</td>
                    </tr>
                    <tr>
                      <td>Bucket max</td>
                      <td>{{ '%0.2f' | format(data["Bucket max"]|float) }} ns</td>
                      <td>Maximum value of the bucket time distribution</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h1 class="panel-title"><b>Hit times, angular dependence</b></h1>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-12">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th width="25.0%">Parameter</th>
                      <th width="25.0%">Value</th>
                      <th width="50.0%">Note</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Direct peaktime</td>
                      <td>{{ data["Direct peaktime"] }} ns</td>
                      <td>The peak of the direct time distribution</td>
                    </tr>
                    <tr>
                      <td>Direct peaks</td>
                      <td>{{ data["Direct peaks"] }}</td>
                      <td>The number of peaks in the direct time distribution</td>
                    </tr>
                    <tr>
                      <td>Residual peaktime</td>
                      <td>{{ data["Residual peaktime"] }} ns</td>
                      <td>The peak of the residual time distribution</td>
                    </tr>
                    <tr>
                      <td>Residual peaks</td>
                      <td>{{ data["Residual peaks"] }}</td>
                      <td>The number of peaks in the residual time distribution</td>
                    </tr>
                    <tr>
                      <td>Direct vs Angle fit</td>
                      <td>{{ '%0.2f' | format(data["Direct vs Angle fit"][0]|float) }} &#177; {{ '%0.3f' | format(data["Direct vs Angle fit"][1]|float) }} ns</td>
                      <td>Average of the direct time distribution as a function of angle</td>
                    </tr>
                    <tr>
                      <td>Residual vs Angle fit</td>
                      <td>{{ '%0.2f' | format(data["Residual vs Angle fit"][0]|float) }} &#177; {{ '%0.3f' | format(data["Residual vs Angle fit"][1]|float) }} ns</td>
                      <td>Average of the residual time distribution as a function of angle</td>
                    </tr>
                    <tr>
                      <td>Dir-Resid fit</td>
                      <td>{{ '%0.2f' | format(data["Dir-Resid fit"][0]|float) }} &#177; {{ '%0.3f' | format(data["Dir-Resid fit"][1]|float) }}</td>
                      <td>Straight line fit to the direct vs residual time distributions</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h1 class="panel-title"><b>Flags</b></h1>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-12">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th width="25.0%">Parameter</th>
                      <th width="25.0%">Value</th>
                      <th width="50.0%">Note</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>TOF flag</td>
                      <td>{{ print_flag(data["TOF flag"]) }}</td>
                      <td>Is the TOF distribution sensible (mean and RMS)?</td>
                    </tr>
                    <tr>
                      <td>TOF min-max flag</td>
                      <td>{{ print_flag(data["TOF min-max flag"]) }}</td>
                      <td>Are the min and max of TOF distribution ok?</td>
                    </tr>
                    <tr>
                      <td>TOF progression flag</td>
                      <td>{{ print_flag(data["TOF progression flag"]) }}</td>
                      <td>Is the TOF descreasing with angle?</td>
                    </tr>
                    <tr>
                      <td>Ang sys flag</td>
                      <td>{{ print_flag(data["Ang sys flag"]) }}</td>
                      <td>Is the AngSys distribution sensible (mean and RMS)?</td>
                    </tr>
                    <tr>
                      <td>Ang sys min-max flag</td>
                      <td>{{ print_flag(data["Ang sys min-max flag"]) }}</td>
                      <td>Are the min and max of AngSys distribution ok?</td>
                    </tr>
                    <tr>
                      <td>Ang sys progression flag</td>
                      <td>{{ print_flag(data["Ang sys progression flag"]) }}</td>
                      <td>Is the AngSys increasing with angle?</td>
                    </tr>
                    <tr>
                      <td>Bucket flag</td>
                      <td>{{ print_flag(data["Bucket flag"]) }}</td>
                      <td>Is the bucket distribution sensible (mean and RMS)?</td>
                    </tr>
                    <tr>
                      <td>Bucket min-max flag</td>
                      <td>{{ print_flag(data["Bucket min-max flag"]) }}</td>
                      <td>Are the min and max of bucket distribution ok?</td>
                    </tr>
                    <tr>
                      <td>Resid peak flag</td>
                      <td>{{ print_flag(data["Resid peak flag"]) }}</td>
                      <td>Is there only one peak in the residual time distribution? Is it close to expected value?</td>
                    </tr>
                    <tr>
                      <td>Direct vs Angle fit flag</td>
                      <td>{{ print_flag(data["Direct vs Angle fit flag"]) }}</td>
                      <td>Is the average of direct light reasonable? Is the distribution flat?</td>
                    </tr>
                    <tr>
                      <td>Residual vs Angle fit flag</td>
                      <td>{{ print_flag(data["Residual vs Angle fit flag"]) }}</td>
                      <td>Is the average of residual light reasonable? Is the distribution flat?</td>
                    </tr>
                    <tr>
                      <td>Dir-Resid fit flag</td>
                      <td>{{ print_flag(data["Dir-Resid fit flag"]) }}</td>
                      <td>Is the straight line fit within limits?</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title"><b>Time-of-Flight</b></h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fToF.png") }}" alt="alt" class="img-responsive">
              </div>
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fToFH.png") }}" alt="alt" class="img-responsive">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title"><b>Angular systematic effect</b></h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fAngSys.png") }}" alt="alt" class="img-responsive">
              </div>
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fAngSysH.png") }}" alt="alt" class="img-responsive">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title"><b>Bucket time</b></h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fBucket.png") }}" alt="alt" class="img-responsive">
              </div>
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fBucketH.png") }}" alt="alt" class="img-responsive">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title"><b>Hit times, angular dependence</b></h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fHitTimesAng.png") }}" alt="alt" class="img-responsive">
              </div>
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fResidTimesAng.png") }}" alt="alt" class="img-responsive">
              </div>
            </div>
            <div class="row">
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fHitTimesRel.png") }}" alt="alt" class="img-responsive">
              </div>
              <div class="col-md-6">
                <img src="{{ url_for('static', filename="pcatellie/" + run + "/" + run + "_val2_fTimes.png") }}" alt="alt" class="img-responsive">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

{% endblock %}
